Assignment1: Data manipulation

Comprises 3 files
1. realestate_brokers_main (MN) contains current wallet balance of credits in broker_id account
2. realestate_broker_account_transaction (TX) contains all transactions to date of broker_id from 2018 to date. The table does not contain the balance at the time of transaction.
3. action_mapping contains transaction_type meaning. i.e. does the transaction_type result in positive or negative increment to credit wallet balance of broker_id due to transaction


Steps to execute
1. Modification of field transaction_type to be applied to TX:
IF (transaction_type = 'adjustment_add' AND remark contains 'CFP') THEN 'topup'
ELSE transaction_type
2. Find the pre and post transaction balance for each transaction in TX by mapping current wallet balance from MN and tracing back into the transaction history based on increments and decrements.   
3. For each transaction in TX, find the previous datetime when wallet balance went below 20 credits. The most recent time in the past should be considered. Call this field previous_expiry.
If balance has not dropped below 20 in the past then take value 01Jan1980. 
4. For each transaction in TX, find the datatime in the future when wallet balance would go below 20 credits.The most recent time in the future should be considered. Call this field next_expiry.
If balance has not dropped below 20 in the future then take value 01Jan2050. 
5. Subset broker_id,transaction_time,account_credits,previous_expiry,next_expiry for only transaction_type = 'topup'


Output should be the file from 5. and code